Data NN
------------
X : numpy.ndarray, shape (2140, 9216) == 2140 examples, 96*96=9216 pixels
X (pixels value)/255 --> scaled back to [0,1]
y : numpy.ndarray, shape (2140, 30) == 2140 examples, 30 labels per image
y ((target position values)-48)/48 --> map grid coordinates to [-1,1]

There are 7039 rows, but only 2140 rows have all 30 targets.
** Think about how to use the rest of them. It's a lot of data! -- data imputation

Data CNN
------------
X : reshaped to (-1,1,96,96)  (?,gray,96rows,96cols)

Data Augmented : Flipped
------------
X : 1/2 images of each batch are flipped

----------------------------------------------------------
----------------------------------------------------------
Net1 : NN
------------
input(1)
hidden1(100)
output(1)

input shape: 1D (None=any, 9216)
output shape: 30 
output non-linearity: None=no activation function on output layer

update : nesterov_momentum=common gradient descent
learning rate : 0.01
momentum : 0.9

output = regression (not classification)
max epochs : 400

MSE = 2.73852
----------------------------------------------------------
----------------------------------------------------------
----------------------------------------------------------
Net2 : CNN
------------
input(1)
conv1(filter=32, filtersize=3*3, poolsize=2*2)
conv2(filter=64, filtersize=2*2, poolsize=2*2)
conv3(filter=128, filtersize=2*2, poolsize=2*2)
hidden4(500)
hidden5(500)
output(1)

input shape: 3D (None=any, 1(gray)*96*96) 
output shape: 30 
output non-linearity: None=no activation function on output layer

update : nesterov_momentum=common gradient descent
learning rate : 0.01
momentum : 0.9

output = regression (not classification)
max epochs : 1000

MSE = 1.99647
----------------------------------------------------------
----------------------------------------------------------
+ DATA AUGMENTATION
----------------------------------------------------------
----------------------------------------------------------
Net3 : (Net2 & Flipping)
------------
net2 architecture +
Batch Iterator : batches of 128 images (half are flipped)

Valid loss = 0.001288
----------------------------------------------------------
----------------------------------------------------------
----------------------------------------------------------
Net4 : (Net2 & Changing Learning Rate + Momentum Over Time)
------------
decrease learning rate over with epochs
increase momentum over with epochs

Valid loss = 0.001387
----------------------------------------------------------
----------------------------------------------------------
----------------------------------------------------------
Net5 : (Net4 & Flipping)
------------
batch_iterator_train=FlipBatchIterator(batch_size=128)

Valid loss = 0.001184
----------------------------------------------------------
----------------------------------------------------------
+ DEAL WITH OVERFITTING
----------------------------------------------------------
----------------------------------------------------------
Net6 : (Net5 & Dropout as Regularization Technique)
------------
Specify Random Dropouts to occur after Convultional layers or Hidden Layers

Be careful of how MSE should be evaluated now. Since dropout occurs during training

Valid loss = 0.001121
Train loss = 0.001306
MSE ~ 0.0010073791
----------------------------------------------------------
----------------------------------------------------------
----------------------------------------------------------
Net7 : (Net6 with 1000 nodes per hidden units instead of 500 only)
------------
hidden4_num_units=1000
dropout4_p=0.5 (higher dropout rate)

Valid loss = 0.001087
Train loss = 0.001195
----------------------------------------------------------
----------------------------------------------------------
----------------------------------------------------------
Net12 : (Net7 with max_epochs = 10000)
------------
max_epochs=10000

Valid loss = 0.000787
Train loss = 0.000760
----------------------------------------------------------
----------------------------------------------------------
----------------------------------------------------------

 Name  |   Description    |  Epochs  |  Train loss  |  Valid loss
-------|------------------|----------|--------------|--------------
 net1  |  single hidden   |     400  |    0.002244  |    0.003255
 net2  |  convolutions    |    1000  |    0.001079  |    0.001566
 net3  |  augmentation    |    3000  |    0.000678  |    0.001288
 net4  |  mom + lr adj    |    1000  |    0.000496  |    0.001387
 net5  |  net4 + augment  |    2000  |    0.000373  |    0.001184
 net6  |  net5 + dropout  |    3000  |    0.001306  |    0.001121
 net7  |  net6 + epochs   |   10000  |    0.000760  |    0.000787